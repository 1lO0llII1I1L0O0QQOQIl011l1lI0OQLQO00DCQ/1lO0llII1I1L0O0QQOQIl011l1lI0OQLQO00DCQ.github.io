<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
	
	 <!-- icon -->
	 <link rel="shortcut icon" href="image/32x32.ico">
	 <link rel="icon" type="image/png" href="image/192x192.png" sizes="192x192">
	 <link rel="apple-touch-icon" sizes="120x120" href="image/120x120.png">
	 <link rel="apple-touch-icon" sizes="152x152" href="image/152x152.png">
	 <link rel="apple-touch-icon" sizes="180x180" href="image/180x180.png">

    <title>聖鯛 - 綠電儲能系統</title>

    <!-- Custom fonts for this template-->
    <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
    <link
        href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
        rel="stylesheet">

    <!-- Custom styles for this template-->
    <link href="css/sb-admin-2.min.css?v=5" rel="stylesheet">
	
    <link href="https://fonts.googleapis.com/earlyaccess/cwtexming.css" rel="stylesheet">

</head>
<body id="page-top">

    <!-- Page Wrapper -->
    <div id="wrapper">

        <!-- Sidebar -->
        <ul class="navbar-nav bg-gradient-primary sidebar sidebar-dark accordion" id="accordionSidebar" >

            <!-- Sidebar - Brand -->
            <a class="sidebar-brand d-flex align-items-center justify-content-center" href="index.html" >
			    <!--<div class="sidebar-brand-text rotate-n-15"><i class="fas fa-fish" style='font-size:24px'></i> <i class="fas fa-sun" style='font-size:24px'></i></div>-->
                <div class="sidebar-brand-icon">
					<font style="font-size:13pt; font-family:'cwTeXMing'">聖 鯛</font>
                </div>
            </a>

            <!-- Divider -->
            <hr class="sidebar-divider my-0">

            <!-- Nav Item - Dashboard -->
            <li class="nav-item active">
                <a class="nav-link" href="index.html">
                    <i class="fas fa-fw fa-tachometer-alt"></i>
                    <span>Dashboard</span></a>
            </li>
			<!-- Divider -->
            <hr class="sidebar-divider">

            <!-- Heading -->
            <div class="sidebar-heading">
                Data
            </div>

            <!-- Nav Item - Charts -->
            <li class="nav-item">
                <a class="nav-link" href="charts.html">
                    <i class="fas fa-fw fa-chart-area"></i>
                    <span>Charts</span></a>
            </li>

            <!-- Nav Item - Tables -->
            <li class="nav-item">
                <a class="nav-link" href="tables.html">
                    <i class="fas fa-fw fa-table"></i>
                    <span>Tables</span></a>
            </li>

            <!-- Divider -->
			
            <!-- Divider -->
            <hr class="sidebar-divider">

            <!-- Heading -->
            <div class="sidebar-heading">
                Others
            </div>

            <!-- Nav Item - Pages Collapse Menu -->
            <li class="nav-item">
                <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseTwo"
                    aria-expanded="true" aria-controls="collapseTwo">
                    <i class="fas fa-fw fa-cog"></i>
                    <span>Components</span>
                </a>
                <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionSidebar">
                    <div class="bg-white py-2 collapse-inner rounded">
                        <h6 class="collapse-header">Custom Components:</h6>
                        <a class="collapse-item" href="buttons.html">Buttons</a>
                        <a class="collapse-item" href="cards.html">Cards</a>
                    </div>
                </div>
            </li>

            <!-- Nav Item - Utilities Collapse Menu -->
            <li class="nav-item">
                <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseUtilities"
                    aria-expanded="true" aria-controls="collapseUtilities">
                    <i class="fas fa-fw fa-wrench"></i>
                    <span>Utilities</span>
                </a>
                <div id="collapseUtilities" class="collapse" aria-labelledby="headingUtilities"
                    data-parent="#accordionSidebar">
                    <div class="bg-white py-2 collapse-inner rounded">
                        <h6 class="collapse-header">Custom Utilities:</h6>
                        <a class="collapse-item" href="utilities-color.html">Colors</a>
                        <a class="collapse-item" href="utilities-border.html">Borders</a>
                        <a class="collapse-item" href="utilities-animation.html">Animations</a>
                        <a class="collapse-item" href="utilities-other.html">Other</a>
                    </div>
                </div>
            </li>

            
            <hr class="sidebar-divider d-none d-md-block">

            <!-- Sidebar Toggler (Sidebar) -->
            <div class="text-center d-none d-md-inline">
                <button class="rounded-circle border-0" id="sidebarToggle"></button>
            </div>

        </ul>
        <!-- End of Sidebar -->

        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column">

            <!-- Main Content -->
            <div id="content">

                <!-- Topbar -->
                <nav class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow">

                    <!-- Sidebar Toggle (Topbar) -->
                    <button id="sidebarToggleTop" class="btn btn-link d-md-none rounded-circle mr-3">
                        <i class="fa fa-bars"></i>
                    </button>
					
					<a class="sidebar-brand d-flex align-items-center justify-content-center " href="index.html"  style="text-decoration:none; ">
						<div class="sidebar-brand-icon rotate-n-15" style="text-bottom" >
							　<p style="margin: 0;"><i class="fas fa-sun" style='font-size:16px'></i></p>
							  <p style="margin: -10 10 -10 -10;"><i class="fas fa-fish" style='font-size:16px'></i></p>
						</div>
						<div class="sidebar-brand-text mx-3" style="font-size:16px; text-align:center;">
							<B>Photovoltaic System</B>
						</div> <!-- background-color:#ECF5FF-->
						
					</a>

                    <!-- Topbar Search -->
					<!--
                    <form
                        class="d-none d-sm-inline-block form-inline mr-auto ml-md-3 my-2 my-md-0 mw-100 navbar-search">
                        <div class="input-group">
								
								<h1 class="h3 mb-0 text-gray-800">Dashboard</h1>
								 
                        </div>
                    </form>
					-->
                    <!-- Topbar Navbar -->
                    <ul class="navbar-nav ml-auto">

                        <!-- Nav Item - Search Dropdown (Visible Only XS) -->
                        <li class="nav-item dropdown no-arrow d-sm-none">
                            
                            <!-- Dropdown - Messages -->
                            <div class="dropdown-menu dropdown-menu-right p-3 shadow animated--grow-in"
                                aria-labelledby="searchDropdown">
                                <form class="form-inline mr-auto w-100 navbar-search">
                                    <div class="input-group">
                                        <input type="text" class="form-control bg-light border-0 small"
                                            placeholder="Search for..." aria-label="Search"
                                            aria-describedby="basic-addon2">
                                        <div class="input-group-append">
                                            <button class="btn btn-primary" type="button">
                                                <i class="fas fa-search fa-sm"></i>
                                            </button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </li>

                        <!-- Nav Item - Alerts -->
                        <li class="nav-item dropdown no-arrow mx-1">
                            <a class="nav-link dropdown-toggle" href="#" id="alertsDropdown" role="button"
                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class="fas fa-bell fa-fw"></i>
                                <!-- Counter - Alerts -->
                                <span class="badge badge-success badge-counter">0</span>
                            </a>
                            <!-- Dropdown - Alerts -->
							<!--
                            <div class="dropdown-list dropdown-menu dropdown-menu-right shadow animated--grow-in"
                                aria-labelledby="alertsDropdown">
                                <h6 class="dropdown-header">
                                    Alerts Center
                                </h6>
                                <a class="dropdown-item d-flex align-items-center" href="#">
                                    <div class="mr-3">
                                        <div class="icon-circle bg-primary">
                                            <i class="fas fa-file-alt text-white"></i>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="small text-gray-500">December 12, 2019</div>
                                        <span class="font-weight-bold">A new monthly report is ready to download!</span>
                                    </div>
                                </a>
                                <a class="dropdown-item d-flex align-items-center" href="#">
                                    <div class="mr-3">
                                        <div class="icon-circle bg-success">
                                            <i class="fas fa-donate text-white"></i>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="small text-gray-500">December 7, 2019</div>
                                        $290.29 has been deposited into your account!
                                    </div>
                                </a>
                                <a class="dropdown-item d-flex align-items-center" href="#">
                                    <div class="mr-3">
                                        <div class="icon-circle bg-warning">
                                            <i class="fas fa-exclamation-triangle text-white"></i>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="small text-gray-500">December 2, 2019</div>
                                        Spending Alert: We've noticed unusually high spending for your account.
                                    </div>
                                </a>
                                <a class="dropdown-item text-center small text-gray-500" href="#">Show All Alerts</a>
                            </div>
							-->
                        </li>

                        <!-- Nav Item - Messages -->
						<!--
                        <li class="nav-item dropdown no-arrow mx-1">
                            <a class="nav-link dropdown-toggle" href="#" id="messagesDropdown" role="button"
                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class="fas fa-envelope fa-fw"></i>
                                <span class="badge badge-danger badge-counter">0</span>
                            </a>
						
                            <!-- Dropdown - Messages -->
							<!--
                            <div class="dropdown-list dropdown-menu dropdown-menu-right shadow animated--grow-in"
                                aria-labelledby="messagesDropdown">
                                <h6 class="dropdown-header">
                                    Message Center
                                </h6>
                                <a class="dropdown-item d-flex align-items-center" href="#">
                                    <div class="dropdown-list-image mr-3">
                                        <img class="rounded-circle" src="img/undraw_profile_1.svg"
                                            alt="...">
                                        <div class="status-indicator bg-success"></div>
                                    </div>
                                    <div class="font-weight-bold">
                                        <div class="text-truncate">Hi there! I am wondering if you can help me with a
                                            problem I've been having.</div>
                                        <div class="small text-gray-500">Emily Fowler · 58m</div>
                                    </div>
                                </a>
                                <a class="dropdown-item d-flex align-items-center" href="#">
                                    <div class="dropdown-list-image mr-3">
                                        <img class="rounded-circle" src="img/undraw_profile_2.svg"
                                            alt="...">
                                        <div class="status-indicator"></div>
                                    </div>
                                    <div>
                                        <div class="text-truncate">I have the photos that you ordered last month, how
                                            would you like them sent to you?</div>
                                        <div class="small text-gray-500">Jae Chun · 1d</div>
                                    </div>
                                </a>
                                <a class="dropdown-item d-flex align-items-center" href="#">
                                    <div class="dropdown-list-image mr-3">
                                        <img class="rounded-circle" src="img/undraw_profile_3.svg"
                                            alt="...">
                                        <div class="status-indicator bg-warning"></div>
                                    </div>
                                    <div>
                                        <div class="text-truncate">Last month's report looks great, I am very happy with
                                            the progress so far, keep up the good work!</div>
                                        <div class="small text-gray-500">Morgan Alvarez · 2d</div>
                                    </div>
                                </a>
                                <a class="dropdown-item d-flex align-items-center" href="#">
                                    <div class="dropdown-list-image mr-3">
                                        <img class="rounded-circle" src="https://source.unsplash.com/Mv9hjnEUHR4/60x60"
                                            alt="...">
                                        <div class="status-indicator bg-success"></div>
                                    </div>
                                    <div>
                                        <div class="text-truncate">Am I a good boy? The reason I ask is because someone
                                            told me that people say this to all dogs, even if they aren't good...</div>
                                        <div class="small text-gray-500">Chicken the Dog · 2w</div>
                                    </div>
                                </a>
                                <a class="dropdown-item text-center small text-gray-500" href="#">Read More Messages</a>
								
                            </div>
							-->
                        </li>

                        <div class="topbar-divider d-none d-sm-block"></div>

                        <!-- Nav Item - User Information -->
                        <li class="nav-item dropdown no-arrow">
                            <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button"
                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <span class="mr-2 d-none d-lg-inline text-gray-600 small">Momo Yan</span>
                                <div class="sidebar-brand-icon">
									<i class="fas fa-user-circle"></i>
								</div>
                            </a>
                            <!-- Dropdown - User Information -->
                            <div class="dropdown-menu dropdown-menu-right shadow animated--grow-in"
                                aria-labelledby="userDropdown">
                                <a class="dropdown-item" href="#">
                                    <i class="fas fa-user fa-sm fa-fw mr-2 text-gray-400"></i>
                                    Profile
                                </a>
                                <a class="dropdown-item" href="#">
                                    <i class="fas fa-cogs fa-sm fa-fw mr-2 text-gray-400"></i>
                                    Settings
                                </a>
                                <a class="dropdown-item" href="#">
                                    <i class="fas fa-list fa-sm fa-fw mr-2 text-gray-400"></i>
                                    Activity Log
                                </a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="#" data-toggle="modal" data-target="#logoutModal">
                                    <i class="fas fa-sign-out-alt fa-sm fa-fw mr-2 text-gray-400"></i>
                                    Logout
                                </a>
                            </div>
                        </li>

                    </ul>

                </nav>
                <!-- End of Topbar -->
				<!-- End of Page Same-->
				
                <!-- Begin Page Content -->
				
				<div class="container-fluid">
					<!-- Content Row -->
                    <div class="row">
					
						<div class="col-lg-6 mb-4">

							<!-- Weather Chart -->
							<div class="card shadow mb-1">
								
								<div class="card-header py-3">
									<h6 class="m-0 font-weight-bold text-primary">新埤鄉 - 即時氣象預報</h6>
								</div>

								<div class="card-body">
									<div class="chart-area" id="weatherReport">
										<canvas id="weatherChart"></canvas>
									</div>
								</div>
							</div>
						</div>
						
					</div>
					
				</div>
				
                <div class="container-fluid" id="containerID" style="display:none;visibility:hidden;">
					
                    <div class="row">

                        <!-- Content Column -->
                        <div class="col-lg-6 mb-4">

                            <!-- Data Card Example -->
                            <div class="card shadow mb-1">
                                <div class="card-header py-3">
                                    <h6 class="m-0 font-weight-bold text-primary">電池資訊</h6>
                                </div>
                                <div class="card-body">
                                    <h4 class="font-weight-bold text-dark">SOC <span
                                            class="float-right" id="socSpanID">120</span></h4>
                                    <div class="progress mb-4">
                                        <div class="progress-bar progress-bar-striped progress-bar-animated bg-info" 
											role="progressbar" style="width: 30%" aria-valuenow="30" 
                                            aria-valuemin="0" aria-valuemax="100" id="socProgressID">30%</div>
											
                                    </div>
									
									<h4 class="small font-weight-bold text-dark">時間<span
                                            class="float-right" id="timeSpanID">2024/01/20 19:22</span></h4>
											
                                    <h4 class="small font-weight-bold text-dark">總電壓<span
                                            class="float-right" id="voltSpanID">540 V</span></h4>
                                    
                                    <h4 class="small font-weight-bold text-dark">總電流<span
                                            class="float-right text-danger" id="currentlySpanID">放電 12 A</span></h4>
	                                <h4 class="small font-weight-bold text-dark">剩餘容量<span
                                            class="float-right" id="capacitySpanID">120 AH</span></h4>								
									<h4 class="small font-weight-bold text-dark" >單體電壓
										<span class="float-right row"  style="width:80%">
												<span class="col bg-danger text-white text-center " id="maxVoltSpanID">
												  3316 V
												</span>
												<span class="col bg-warning text-white text-center " id="avgVoltSpanID">
												  3311 V
												</span>
												<span class="col  bg-success text-white text-center " id="minVoltSpanID">
												  3306 V
												</span>
												
										</span>
									</h4>	
                                    <h4 class="small font-weight-bold text-dark" >單體溫度
										<span class="float-right row" style="width:80%">
												<span class="col bg-danger text-white text-center " id="maxTempSpanID">
												  25 ℃
												</span>
												<span class="col bg-warning text-white text-center " id="avgTempSpanID">
												  23 ℃
												</span>
												<span class="col  bg-success text-white text-center " id="minTempSpanID">
												  22 ℃
												</span>
												
										</span>
									</h4>	
                                    <h4 class="small font-weight-bold text-dark">在線簇數<span
                                            class="float-right" id="olineNumSpanID">4 簇</span></h4>
									<h4 class="small font-weight-bold text-dark">在線電芯數<span
                                            class="float-right" id="cellNumSpanID">640 串</span></h4>
									<h4 class="small font-weight-bold text-dark">在線溫感數<span
                                            class="float-right" id="tempNumSpanID">240 串</span></h4>
                                    
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-6 mb-4">
                            <!-- MPPT -->
                            <div class="card shadow mb-4">
                                <div class="card-header py-3">
                                    <h6 class="m-0 font-weight-bold text-primary">MPPT & PCS 資訊</h6>
                                </div>
                                <div class="card-body">
                                    <h4 class="small font-weight-bold text-dark">
									<button type="button" class="btn btn-sm btn-success " id="MPPTSWID" disabled>MPPT 開啟</button>
									<span class="float-right" id="socSpanID">
										<button type="button" class="btn btn-sm btn-success" id="MPPTFlagID" disabled>正常運作</button>
									</span>
									</h4>
											
									
                                    <h4 class="small font-weight-bold text-dark">高壓側電壓
										<span class="float-right" id="MPPTvoltHSpanID">6621 V</span></h4>
                                    
                                    <h4 class="small font-weight-bold text-dark">低壓側電壓
										<span class="float-right" id="MPPTvoltLSpanID">1 V</span></h4>
											
                                    <h4 class="small font-weight-bold text-dark">低壓側電流<span
                                            class="float-right text-danger" id="MPPTCurrentlyLSpanID">0 A</span></h4>
											
                                    <h4 class="small font-weight-bold text-dark">低壓側功率<span
                                            class="float-right" id="MPPTPowerSpanID">0 kW</span></h4>
									
									<!-- PCS -->
									<h4 class="small font-weight-bold text-dark">
									<button type="button" class="btn btn-sm btn-success" id="PCSSWID" disabled>PCS 開啟 - 狀態 9</button>
									<span class="float-right" id="socSpanID">
										<button type="button" class="btn btn-sm btn-success" id="PCSFlagID" disabled>正常運作</button>
										<!--<button type="button" class="btn btn-sm btn-danger" id="MPPTFlagID" disabled>異常故障</button>-->
									</span>
									</h4>
									<h4 class="small font-weight-bold text-dark">DC端電壓<span
                                            class="float-right" id="PCSDCVoltSpanID">662 V</span></h4>
                                    
                                    <h4 class="small font-weight-bold text-dark">DC輸出功率<span
                                            class="float-right" id="PCSDCPowerSpanID">62 kW</span></h4>
											
                                    <h4 class="small font-weight-bold text-dark">DC輸出電流<span
                                            class="float-right"  id="PCSDCCurrentSpanID">95 A</span></h4>
											
                                    <h4 class="small font-weight-bold text-dark">AC輸出有效功率<span
                                            class="float-right"  id="PCSACPowerSpanID">50 kW</span></h4>
									<h4 class="small font-weight-bold text-dark">AC輸出無效功率<span
									class="float-right" id="PCSACVarSpanID">0 kW</span></h4>

											
                                </div>
                            </div>

                        </div>
                    </div>
                    
					

                </div>
                <!-- /.container-fluid -->
				<div class="d-flex justify-content-center" id="loading">
					  <div class="spinner-border" role="status">
						<span class="visually-hidden;"></span>
					  </div>
					  <div style="font-size:17pt">  　讀取儲能系統資料中</div>
				</div>
            </div>
            <!-- End of Main Content -->

            <!-- Footer -->
            <footer class="sticky-footer bg-white">
                <div class="container my-auto">
                    <div class="copyright text-center my-auto">
                        <span>Copyright &copy; 聖鯛水產科技有限公司 2024</span>
                    </div>
                </div>
            </footer>
            <!-- End of Footer -->

        </div>
        <!-- End of Content Wrapper -->

    </div>
    <!-- End of Page Wrapper -->

    <!-- Scroll to Top Button-->
    <a class="scroll-to-top rounded" href="#page-top">
        <i class="fas fa-angle-up"></i>
    </a>

    <!-- Logout Modal-->
    <div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Ready to Leave?</h5>
                    <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                </div>
                <div class="modal-body">Select "Logout" below if you are ready to end your current session.</div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
                    <a class="btn btn-primary" href="login.html">Logout</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap core JavaScript-->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Core plugin JavaScript-->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- Custom scripts for all pages-->
    <script src="js/sb-admin-2.min.js"></script>

    <!-- Page level plugins -->
    <script src="vendor/chart.js/Chart.min.js"></script>

    <!-- Page level custom scripts -->
    <script src="js/demo/chart-area-demo.js"></script>
    <!--<script src="js/demo/chart-pie-demo.js"></script>-->
	
	<script>
		getData();
		async function getData() {
				
			// momo
			// 搜尋條件 溫度=> %E6%BA%AB%E5%BA%A6  天氣現象 => %E5%A4%A9%E6%B0%A3%E7%8F%BE%E8%B1%A1  
			const uriWeather = 'https://opendata.cwa.gov.tw/api/v1/rest/datastore/F-D0047-033?Authorization=CWA-AC9B44D3-2CAC-44B7-8051-CB5FD07D7276&LocationName=%E6%96%B0%E5%9F%A4%E9%84%89&ElementName=%E6%BA%AB%E5%BA%A6,%E5%A4%A9%E6%B0%A3%E7%8F%BE%E8%B1%A1'+'&v=2024-12-20' // +  Date.now();  // 2024-12-20 locationName -> LocationName & elementName -> ElementName
			const responseWeather = await fetch(uriWeather);
			const dataWeather = await responseWeather.json();
			var jsonDataWeather = dataWeather.records.Locations[0].Location[0]; // 2024-12-20 locations -> Locations & location -> Location
			console.log(jsonDataWeather);
			var countLabels = 0;
			
			
			var timeLabels = [];
			var wxValue1 = [];
			var tempValue1 = [];
			var weatherStyle1 = [];
			
			var wxValue2 = [];
			var tempValue2 = [];
			var weatherStyle2 = [];
			
			
			var dayBigRainIcon = new Image();
			dayBigRainIcon.src = "img/weather/resize25/dayBigRainIcon.svg"; //白天 + 有雨
			
			var dayCloudIcon = new Image();
			dayCloudIcon.src = "img/weather/resize25/dayCloudIcon.svg"; //白天 + 多雲
			
			var dayDarkIcon = new Image();
			dayDarkIcon.src = "img/weather/resize25/dayDarkIcon.svg"; //白天 + 陰
			
			var daySmallRainIcon = new Image();
			daySmallRainIcon.src = "img/weather/resize25/daySmallRainIcon.svg"; //白天 + 短暫雨
			
			var daySunIcon = new Image();
			daySunIcon.src = "img/weather/resize25/daySunIcon.svg"; //白天 + 晴
			
/*			多雲時陰 
			陰短暫雨
			
			對照表 https://www.cwa.gov.tw/V8/C/K/Weather_Icon.html
			
			https://www.cwa.gov.tw/V8/assets/img/weather_icons/weathers/svg_icon/night/01.svg
*/
			
			
			var nightBigRainIcon = new Image();
			nightBigRainIcon.src = "img/weather/resize25/nightBigRainIcon.svg"; //晚上 + 有雨
			
			var nightCloudIcon = new Image();
			nightCloudIcon.src = "img/weather/resize25/nightCloudIcon.svg"; //晚上 + 多雲
			
			var nightDarkIcon = new Image();
			nightDarkIcon.src = "img/weather/resize25/nightDarkIcon.svg"; //晚上 + 陰
			
			var nightSmallRainIcon = new Image();
			nightSmallRainIcon.src = "img/weather/resize25/nightSmallRainIcon.svg"; //晚上 + 短暫雨
			
			var nightSunIcon = new Image();
			nightSunIcon.src = "img/weather/resize25/nightSunIcon.svg"; //晚上 + 晴
			
			var dayCount = 0;
			var oldDateStr = "";
			
			for (var i=0; countLabels<10; i++) // jsonDataWeather.weatherElement[0].time.length 共32筆
			{
				var startTime = jsonDataWeather.WeatherElement[1].Time[i].StartTime; // 2024-12-20 weatherElement -> WeatherElement & time -> Time & startTime -> StartTime
				//console.log(startTime);
				var parseDate = startTime.slice(5,10);  // 2024-12-20T10:00:00+08:00 => 從1開始擷取0 => result: 12-20
				
				if (oldDateStr !== parseDate)
				{
					if (dayCount == 2)
					{
						break;
					}
					oldDateStr = parseDate;
					dayCount++;
				}
							
				var parseTime = startTime.slice(11,13);  // 2024-12-20T10:00:00+08:00  => result: 10
				//console.log(parseTime);
				var wxDesc = jsonDataWeather.WeatherElement[1].Time[i].ElementValue[0].Weather; // 2024-12-20 weatherElement -> WeatherElement & time -> Time & elementValue -> ElementValue
				//console.log(jsonDataWeather.WeatherElement[1]);
				//console.log(wxDesc);
				//var parseDate = startTime.slice(5,10);   // 2024-12-20T10:00:00+08:00  => result: 12-20
				var wxNum = jsonDataWeather.WeatherElement[1].Time[i].ElementValue[0].WeatherCode; // 2024-12-20 weatherElement -> WeatherElement & time -> Time & elementValue -> ElementValue
				
				
				//console.log(dayCount);
				if (dayCount == 1)
				{	
					// set weather icon
					if ( parseTime.indexOf('21')>=0 || parseTime.indexOf('00')>=0 || parseTime.indexOf('03')>=0)
					{
						continue;// do nothing
					}
					else if (parseTime.indexOf('18')>=0) //night
					{
						var MyImage = new Image();
						MyImage.src = 'img/weather/resize25/night/'+ wxNum +'.svg';
						weatherStyle1.push(MyImage);
					}
					else //day
					{
						var MyImage = new Image();
						MyImage.src = 'img/weather/resize25/day/'+ wxNum +'.svg';
						weatherStyle1.push(MyImage);						
					}
					//console.log('今天 ' + parseTime + ' 點' + wxDesc);
					timeLabels.push('今天 ' + parseTime + ' 點');
					
					wxValue1.push(wxDesc);
					console.log(jsonDataWeather.WeatherElement[0].Time[i]);
					tempValue1.push(jsonDataWeather.WeatherElement[0].Time[i].ElementValue[0].Temperature); // 2024-12-20 weatherElement -> WeatherElement & time -> Time & elementValue -> ElementValue
					
					
					weatherStyle2.push(null);
					wxValue2.push(null);
					tempValue2.push(null);
					
					countLabels ++; 
				}
				else if (dayCount == 2)
				{
					
					// set weather icon
					if ( parseTime.indexOf('21')>=0 || parseTime.indexOf('00')>=0 || parseTime.indexOf('03')>=0)
					{
						continue;// do nothing
					}
					else if (parseTime.indexOf('18')>=0) //night
					{
						var MyImage = new Image();
						MyImage.src = 'img/weather/resize25/night/'+ wxNum +'.svg';
						weatherStyle2.push(MyImage);
					}
					else //day
					{
						var MyImage = new Image();
						MyImage.src = 'img/weather/resize25/day/'+ wxNum +'.svg';
						weatherStyle2.push(MyImage);						
					}
					
					//console.log('明天 ' + parseTime + ' 點' + wxDesc);
					timeLabels.push('明天 ' + parseTime + ' 點');
					wxValue2.push(wxDesc);
					tempValue2.push(jsonDataWeather.WeatherElement[0].Time[i].ElementValue[0].Temperature); // 2024-12-20 weatherElement -> WeatherElement & time -> Time & elementValue -> ElementValue
					
					weatherStyle1.push(null);
					wxValue1.push(null);
					tempValue1.push(null);
				
					countLabels ++; 
				}
				
				
			}
			/*
			console.log(timeLabels);
			console.log(tempValue1);
			console.log(tempValue2);
			console.log(weatherStyle1);
			console.log(weatherStyle2);
			*/
			
			// weatherChart
			document.querySelector("#weatherReport").innerHTML = '<canvas id="weatherChart"></canvas>';
			var weatherChart = document.getElementById("weatherChart");
			var weatherCharttData = new Chart(weatherChart, {
			  type: 'line',
			  data: {
				labels: timeLabels,				  
				datasets: 
				[
					{
					  label: "今天溫度",
					  lineTension: 0.3,
					  backgroundColor: "rgba(54, 185, 204, 0.05)", //#36b9cc - info color
					  borderColor: "rgba(54, 185, 204, 1)",
					  pointRadius: 2,
					  pointBackgroundColor: "rgba(54, 185, 204, 1)",
					  pointBorderColor: "rgba(54, 185, 204, 1)",
					  pointHoverRadius: 5,
					  pointHoverBackgroundColor: "#f8f9fc", //light
					  pointHoverBorderColor: "rgba(54, 185, 204, 1)",
					  pointHitRadius: 10,
					  pointBorderWidth: 2,
					  data: tempValue1,
					  pointStyle: weatherStyle1
					},
					{
					  label: "明天溫度",
					  lineTension: 0.3,
					  backgroundColor: "rgba(246, 194, 62, 0.05)", // #f6c23e warning color
					  borderColor: "rgba(246, 194, 62, 1)",
					  pointRadius: 2,
					  pointBackgroundColor: "rgba(246, 194, 62,  1)",
					  pointBorderColor: "rgba(246, 194, 62,  1)",
					  pointHoverRadius: 5,
					  pointHoverBackgroundColor: "#f8f9fc", //light
					  pointHoverBorderColor: "rgba(246, 194, 62,  1)",
					  pointHitRadius: 10,
					  pointBorderWidth: 2,
					  data: tempValue2,
					  pointStyle: weatherStyle2
					}
				],
			  },
			  options: {
				maintainAspectRatio: false,
				layout: {
				  padding: {
					left: 0,
					right: 0,
					top: 0,
					bottom: 0
				  }
				},
				scales: {
				  xAxes: [{
					time: {
					  unit: 'date'
					},
					gridLines: {
					  display: true,
					  drawBorder: true
					},
					ticks: {
					  maxTicksLimit: timeLabels.length,
					  fontSize: 10
					}
				  }],
				  yAxes: [{
					ticks: {
					  maxTicksLimit: 5,
					  padding: 10,
					  // Include a dollar sign in the ticks
					  callback: function(value, index, values) {
						return number_format(value) + '℃';
					  }
					},
					gridLines: {
					  color: "rgb(234, 236, 244)",
					  zeroLineColor: "rgb(234, 236, 244)",
					  drawBorder: false,
					  borderDash: [2],
					  zeroLineBorderDash: [2]
					}
				  }],
				},
				legend: {
				  display: false
				},
				tooltips: {
				  backgroundColor: "rgb(255,255,255)",
				  bodyFontColor: "#858796",
				  titleMarginBottom: 10,
				  titleFontColor: '#6e707e',
				  titleFontSize: 14,
				  borderColor: '#dddfeb',
				  borderWidth: 1,
				  xPadding: 15,
				  yPadding: 15,
				  displayColors: false,
				  intersect: false,
				  mode: 'index',
				  caretPadding: 10,
				  callbacks: {
					label: function(tooltipItem, chart) {
					  var datasetLabel = chart.datasets[tooltipItem.datasetIndex].label || '';
					  return datasetLabel + ': ' + number_format(tooltipItem.yLabel) + '℃';
					}
				  }
				}
			  }
			});
/*
			Chart.pluginService.register({
				afterUpdate: function(weatherChart) {
					weatherChart.config.datasets[0].data.pointStyle[1] = sun;
					//http://www.java2s.com/example/javascript/chart.js/chartjs-to-display-legend.html
					//chart.config.data.datasets[1]._meta[0].data[2]._model.pointStyle = sun;
				}
			});
*/
			/*
				const config = {
			  type: 'line',
			  data: data,
			  options: {
				responsive: true,
				plugins: {
				  title: {
					display: true,
					text: (ctx) => 'Point Style: ' + ctx.chart.data.datasets[0].pointStyle,
				  }
				}
			  }
			};
			*/
		
			//today https://github.com/gavinpwd/weather-app/blob/master/js/index.js
			
			// Call 5 day / 3 hour forecast data https://openweathermap.org/forecast5 
			//https://api.openweathermap.org/data/2.5/forecast?lat=22.4787359&lon=120.5659494&appid=ea102967bfa542930faa56f6bc4a34c7
			
			document.getElementById('loading').style = "";
			document.getElementById('containerID').style = "display:none; visibility:hidden";
			
			const googleUriString = 'https://script.google.com/macros/s/AKfycbxv6pts1O9krN6PaehCt64zPAmdea_3TpYj5wg_DiHZ3DmONeHsvz0_-6A_y4Ut8Paglg/exec';
			
			const uri = googleUriString + '?date=dashboard';
			const response = await fetch(uri);
			const data = await response.json();
			var item = data[0];
			
			var socSpanID = document.getElementById('socSpanID');
			socSpanID.textContent ='(' + item.capacity + ')'; 
			var socProgressID = document.getElementById('socProgressID');
			socProgressID.textContent = item.soc + '%';
			socProgressID.style.width = item.soc + '%';
			//error socProgressIDEle.attr('aria-valuenow', '60');
			var timeSpanID = document.getElementById('timeSpanID');
			timeSpanID.textContent = item.time;
			var voltSpanID = document.getElementById('voltSpanID');
			voltSpanID.textContent = item.volt + ' V';
			var currentlySpanID = document.getElementById('currentlySpanID');
			if (item.currently > 0)
			{
				currentlySpanID.textContent = '充電 '  + item.currently + ' A';
			}
			else
			{
				currentlySpanID.textContent = '放電 '  + item.currently + ' A';
			}
			
			var capacitySpanID = document.getElementById('capacitySpanID');
			capacitySpanID.textContent = item.capacity + ' AH';
			
			var olineNumSpanID =  document.getElementById('olineNumSpanID');
			olineNumSpanID.textContent = item.OlineNum + ' 簇';
			
			var cellNumSpanID =  document.getElementById('cellNumSpanID');
			cellNumSpanID.textContent = item.CellNum + ' 串';
			
			var tempNumSpanID =  document.getElementById('tempNumSpanID');
			tempNumSpanID.textContent = item.TempNum + ' 串';
			
			var avgTempSpanID =  document.getElementById('avgTempSpanID');
			avgTempSpanID.textContent = item.avgTemp + ' ℃';
			
			var maxTempSpanID =  document.getElementById('maxTempSpanID');
			maxTempSpanID.textContent = item.MaxTemp + ' ℃';
			
			var minTempSpanID =  document.getElementById('minTempSpanID');
			minTempSpanID.textContent = item.MinTemp + ' ℃';
			
			var avgVoltSpanID =  document.getElementById('avgVoltSpanID');
			avgVoltSpanID.textContent = item.avgVolt + '';
			
			var maxVoltSpanID =  document.getElementById('maxVoltSpanID');
			maxVoltSpanID.textContent = item.MaxVolt + '';
			
			var minVoltSpanID =  document.getElementById('minVoltSpanID');
			minVoltSpanID.textContent = item.MinVolt + '';
			
			var MPPTSWID =  document.getElementById('MPPTSWID');
			
			if (item.MPPT1_Sw == true)
			{
				MPPTSWID.className = "btn btn-sm btn-success ";
				MPPTSWID.textContent = 'MPPT 開啟';
			}
			else
			{
				MPPTSWID.className = "btn btn-sm btn-danger ";
				MPPTSWID.textContent = 'MPPT 關閉';
			}
			
			var MPPTFlagID =  document.getElementById('MPPTFlagID');
			
			if (item.failFlagMPPT == '正常')
			{
				MPPTFlagID.className = "btn btn-sm btn-success ";
				MPPTFlagID.textContent = '正常運作';
			}
			else
			{
				MPPTFlagID.className = "btn btn-sm btn-danger ";
				MPPTFlagID.textContent = '異常故障';
			}
			
			
			var MPPTvoltHSpanID =  document.getElementById('MPPTvoltHSpanID');
			MPPTvoltHSpanID.textContent = item.MPPT1Volt_H + ' V';
			
			var MPPTvoltLSpanID =  document.getElementById('MPPTvoltLSpanID');
			MPPTvoltLSpanID.textContent = item.MPPT1Volt_L + ' V';
			
			var MPPTCurrentlyLSpanID =  document.getElementById('MPPTCurrentlyLSpanID');
			MPPTCurrentlyLSpanID.textContent = item.MPPT1Currently_L + ' A';

			var MPPTPowerSpanID =  document.getElementById('MPPTPowerSpanID');
			MPPTPowerSpanID.textContent = item.MPPT1Power_L + ' kW';


			var PCSSWID =  document.getElementById('PCSSWID');
			
			if (item.PCS_Sw == true)
			{
				PCSSWID.className = "btn btn-sm btn-success ";
				PCSSWID.textContent = 'PCS 開啟 - 狀態 ' + item.PCS_Status;
			}
			else
			{
				PCSSWID.className = "btn btn-sm btn-danger ";
				PCSSWID.textContent = 'PCS 關閉 - 狀態 ' + item.PCS_Status;
			}
			
			var PCSFlagID =  document.getElementById('PCSFlagID');
			
			if (item.failFlagPcs == '正常')
			{
				PCSFlagID.className = "btn btn-sm btn-success ";
				PCSFlagID.textContent = '正常運作';
			}
			else
			{
				PCSFlagID.className = "btn btn-sm btn-danger ";
				PCSFlagID.textContent = '異常故障';
			}

			var PCSDCVoltSpanID =  document.getElementById('PCSDCVoltSpanID');
			PCSDCVoltSpanID.textContent = item.PCSDC_Volt + ' V';

			var PCSDCPowerSpanID =  document.getElementById('PCSDCPowerSpanID');
			PCSDCPowerSpanID.textContent = item.PCSDC_Power + ' kW';

			var PCSDCCurrentSpanID =  document.getElementById('PCSDCCurrentSpanID');
			PCSDCCurrentSpanID.textContent = item.PCSDC_Currently + ' A';

			var PCSACPowerSpanID =  document.getElementById('PCSACPowerSpanID');
			PCSACPowerSpanID.textContent = item.PCSAC_Power + ' A';

			var PCSACVarSpanID =  document.getElementById('PCSACVarSpanID');
			PCSACVarSpanID.textContent = item.PCSAC_Var + ' A';


			document.getElementById('loading').style = "display:none; visibility:hidden;";
			document.getElementById('containerID').style = "";
		}
		
		
	</script>
</body>

</html>